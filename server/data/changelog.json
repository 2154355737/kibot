{
  "version": "1.4.9",
  "releaseDate": "2025-10-21",
  "changelog": [
    {
      "version": "1.4.9",
      "date": "2025-10-21",
      "title": "智能更新系统与路径修复 🚀",
      "features": [
        "🚀 智能后端更新系统 - 一键更新，自动保护数据",
        "📦 命令行更新工具 - npm run update 快速更新",
        "🌐 Web拖拽上传更新 - 在 /system/update 页面拖拽ZIP包即可",
        "💾 自动版本备份 - 更新前自动备份，保留最近5个版本",
        "🔒 智能数据保护 - 自动识别并保护用户配置、数据、插件",
        "🔄 失败自动回滚 - 更新失败立即恢复到之前版本",
        "📊 实时更新进度 - Web界面显示详细进度和日志",
        "📝 更新日志记录 - 完整记录每次更新的全过程",
        "🔍 历史记录查看 - 查看所有更新历史，支持日志详情",
        "⏮️ 一键恢复备份 - Web界面选择备份点击恢复",
        "📖 动态更新日志 - 关于页面从后端API实时加载版本信息",
        "🔄 自动版本刷新 - 页面每30秒自动检查版本更新"
      ],
      "improvements": [
        "🔧 task-manager.js 路径修复 - 移除硬编码的'server','server'",
        "🔧 event-engine.js 路径修复 - 使用__dirname相对路径",
        "🔧 plugin-manager.js 路径修复 - 统一使用模块相对路径",
        "🔧 plugin-sdk.js 路径修复 - 修正存储目录路径",
        "🔧 session-manager.js 路径修复 - 简化配置文件路径处理",
        "🔧 output-manager.js 路径修复 - 日志目录使用相对路径",
        "🔧 monitor-data-manager.js 路径修复 - 监控数据路径优化",
        "🛡️ 防止递归复制 - 检测并阻止目标路径在源路径内的复制",
        "🛡️ 智能跳过目录 - 自动跳过.开头和temp-开头的目录",
        "🔍 结构检查工具 - npm run check-structure 检测嵌套问题",
        "📋 构建脚本优化 - 新增9个步骤，包含嵌套检查和验证",
        "📊 更新器启动日志 - 后端启动时显示更新器状态"
      ],
      "security": [
        "🔒 版本验证 - 禁止降级更新，防止回退到有漏洞的版本",
        "🔒 文件名格式验证 - 必须为 QQBot-vX.X.X.zip 或 KiBot-vX.X.X.zip",
        "🔒 结构完整性检查 - 验证关键文件和目录存在",
        "🔒 MD5校验和 - 为每个更新包生成MD5哈希值",
        "🔒 嵌套结构检测 - 禁止server/server等错误结构",
        "🔒 用户数据检测 - 检测并警告更新包中的用户数据",
        "🛡️ 更新权限验证 - Web更新需要管理员权限",
        "🛡️ 文件上传验证 - 只接受.zip格式文件"
      ],
      "optimizations": [
        "⚡ 文件上传日志优化 - 从每64KB一次降到每1MB一次，减少93%输出",
        "⚡ 备份速度提升10倍 - 自动排除.updates和node_modules",
        "⚡ 文件大小显示优化 - 统一使用MB单位，更易读",
        "⚡ 智能目录跳过 - 复制时自动跳过临时文件和隐藏目录",
        "📊 进度条精确显示 - 10个主要步骤，百分比实时更新",
        "🧹 自动清理旧备份 - 超过5个自动删除最旧的",
        "🔍 日志分类显示 - INFO/SUCCESS/WARNING/ERROR彩色输出"
      ],
      "bugfixes": [
        "🐛 修复 server/server/server 三层嵌套bug",
        "🐛 修复备份时复制.updates导致的无限递归",
        "🐛 修复 Windows tar 不支持 --wildcards 参数",
        "🐛 修复文件上传时multipart边界解析问题",
        "🐛 修复JSON解析导致二进制数据损坏",
        "🐛 修复文件上传请求体被提前读取的问题",
        "🐛 修复路径中硬编码'server','server'的问题",
        "🐛 修复构建脚本未包含changelog.json",
        "🐛 修复更新完成后关于页面版本不刷新"
      ],
      "docs": [
        "📖 server/README-UPDATE.md - 331行完整使用指南",
        "📖 CHANGELOG-v1.4.9.md - 快速更新说明",
        "📖 文档/更新日志/更新日志-2025-10-21-v1.4.9智能更新系统.md - 详细更新日志",
        "📖 更新流程图 - 详细的13步更新流程说明",
        "📖 故障排查指南 - 常见问题和解决方案",
        "📖 安全特性文档 - 多重验证机制说明",
        "📖 API接口文档 - 8个更新器API详细说明",
        "📖 最佳实践指南 - 更新前、中、后的操作建议"
      ]
    },
    {
      "version": "1.4.8",
      "date": "2025-10-18",
      "title": "插件系统v3.0与前端优化",
      "features": [
        "🔌 插件系统v3.0重大升级 - 支持Simple/Enhanced/Original三种SDK",
        "💬 完整的聊天系统 - 支持好友和群组聊天",
        "📊 监控数据归档和导出功能",
        "🔐 增强的安全验证机制"
      ],
      "improvements": [
        "📦 CQ码处理系统 - 完整的解析和构建API",
        "🛡️ 插件错误记录增强 - 自动捕获和Web界面展示",
        "🔧 插件生成器v3 - 交互式创建工具",
        "💾 ORM数据模型 - Enhanced SDK内置存储"
      ],
      "optimizations": [
        "⚡ 插件加载性能提升30%",
        "⚡ 事件处理性能提升20%",
        "📉 内存占用降低15%"
      ]
    },
    {
      "version": "1.4.5",
      "date": "2025-10-17",
      "title": "性能优化与功能完善",
      "features": [
        "📊 错误日志界面 - 新增插件错误日志标签页",
        "🎨 插件详情界面优化"
      ],
      "optimizations": [
        "⚡ 减少API调用频率",
        "⚡ 优化前端渲染性能",
        "📝 日志系统增强"
      ]
    },
    {
      "version": "1.4.1",
      "date": "2025-10-17",
      "title": "UI优化与工具指令",
      "features": [
        "🎯 新增工具指令系统",
        "🤖 自动化规则模板 - 欢迎新成员、自动回复、定时提醒等",
        "✨ 登录页面UI优化 - 渐变背景和图标"
      ],
      "improvements": [
        "📱 移动端导航栏增强 - 触摸反馈和动画",
        "🎨 侧边栏和底部导航栏视觉效果提升",
        "🎯 交互按钮添加触摸反馈",
        "♿ 增强无障碍性支持"
      ],
      "optimizations": [
        "🔧 事件引擎性能提升",
        "📝 日志输出优化",
        "⚡ 页面加载和响应速度优化"
      ],
      "security": [
        "🛡️ 权限控制机制完善"
      ]
    },
    {
      "version": "1.3.0",
      "date": "2025-10-06",
      "title": "隐私保护与安全增强",
      "features": [
        "📄 隐私条款和免责协议功能",
        "🔒 首次使用强制阅读并同意协议",
        "📱 协议界面完全适配移动端和PC端"
      ],
      "security": [
        "🔐 HTTP API安全验证修复",
        "🛡️ 完善权限验证机制"
      ],
      "optimizations": [
        "📝 事件引擎日志优化",
        "⚡ 减少日志输出，降低I/O开销"
      ]
    },
    {
      "version": "1.2.0",
      "date": "2025-10-06",
      "title": "监控系统与UI改进",
      "features": [
        "✨ 新增About介绍页面",
        "📊 系统监控界面优化",
        "🎨 完整的深色模式适配"
      ],
      "improvements": [
        "📱 移动端导航优化",
        "⚡ 定时任务功能增强",
        "🔧 HTTP API架构优化"
      ],
      "security": [
        "🛡️ SSRF安全修复"
      ]
    }
  ]
}

